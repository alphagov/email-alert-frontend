<% content_for :title, "Subscribe to updates" %>

<% content_for :head do %>
  <meta name="robots" content="noindex, nofollow">
<% end %>

<% content_for :head_css do %>
  <%= stylesheet_link_tag "application-without-elements" %>
<% end %>

<%= render "govuk_component/breadcrumbs", breadcrumbs: @breadcrumbs %>

<%= render "govuk_publishing_components/components/back_link", {
  href: @back_url,
} %>

<div class="grid-row">
  <div class="column-two-thirds">
    <% if flash[:error] %>
      <%= render "govuk_publishing_components/components/error_summary", {
        title: "We weren’t able to process your subscription",
        items: [
          {
            text: "There is a problem with your email address",
            href: "#email-address-input",
          }
        ]
      } %>
    <% end %>

    <%= render partial: "govuk_component/title", locals: {
      average_title_length: "long",
      title: "Subscribe to updates",
    } %>

    <%= render "govuk_component/govspeak", {
      content: [
        "<p>You’re subscribing to get email notifications about ‘#{@title}’.</p>",
        "<p>You’ll get an email as soon as something changes.</p>",
      ].join
    } %>

    <%= form_tag create_subscription_path, method: :post do %>
      <%= hidden_field_tag :topic_id, @topic_id %>
      <%= hidden_field_tag :frequency, @frequency %>

      <%= render "govuk_publishing_components/components/input", {
        error_message: flash[:error],
        id: "email-address-input",
        label: { text: "What is your email address?" },
        name: :address,
        type: "email",
        value: @address,
      } %>

      <%= render "govuk_component/button", {
        text: "Subscribe",
        margin_bottom: true,
      } %>
    <%- end -%>
  </div>
</div>
